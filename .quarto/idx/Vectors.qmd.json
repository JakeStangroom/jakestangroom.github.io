{"title":"Vectors","markdown":{"headingText":"Vectors","headingAttr":{"id":"sec-day2-vect","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\nLet us build on the basics of *Vectors* which were covered previously. Vectors are essential for organizing and performing calculations on larger collections of data when used correctly. Below, we cover the best practice for assignment of vectors and optimal calculations using vectors.\n\n## Vector Assignment\n\nThe code chunk below exemplifies the performance benefits of avoiding unnecessary appending to vectors (or just appending in general), especially when first constructing your vector.\n\n```{r performance1}\nlen <- 10000\nstartTime <- Sys.time()\n\nstorage <- c()\nfor (i in 1:len){\n  storage <- c(storage, i)\n}\n\n(badExec <- Sys.time() - startTime)\nrm(storage)\n\n\nstartTime <- Sys.time()\n\nstorage <- numeric(len)\nfor (i in 1:len){\n  storage[i] <- i\n}\n\n(goodExec <- Sys.time() - startTime)\n\n```\n\n## Vectorisation\n\nVectorization is the process of performing operations on entire vectors or arrays instead of using explicit loops of single scalars. It takes advantage of R's optimized internal functions, leading to faster and more efficient code execution.\n\nThere are a few benefits for vectorisation - **Speed**: Vectorized operations are significantly faster than loops. - **Conciseness**: Code is shorter and easier to read. - **Optimized Performance**: R's internal functions are written in compiled languages like *C* and *Fortran*, making them more efficient than explicit loops.\n\nThere are several base operations in R which have been extended from single scalar operations to vector operations where both the inputs and outputs are vectors. This operates in the same way as looping through the scalar input versions; however, much quicker.\n\n### Performance\n\nEven for a simple squaring function, the performance difference between vectorisation and for loops is present.\n\n```{r}\nlen <- 10000\nstartTime <- Sys.time()\n\nstorage <- numeric(len)\nfor (i in 1:len){\n  storage[i] <- i^2\n}\n\n(badExec <- Sys.time() - startTime)\n\nrm(storage)\nstartTime <- Sys.time()\n\nstorage <- (1:len)^2\n\n(goodExec <- Sys.time() - startTime)\n\n```\n\n### Creating Vectorised Functions\n\nWhen one makes a function of scalar inputs, R provides a simple method to transform them into a vectorised version of the function as follows:\n\n```{r}\n\nf <- function(a, b){\n  return(a^b)\n}\n\nfVec <- Vectorize(f, vectorize.args = 'a')\n\n\nlen <- 1000\nstartTime <- Sys.time()\n\nstorage <- numeric(len)\nfor (i in 1:len){\n  storage[i] <- f(i, i)\n}\n\n(badExec <- Sys.time() - startTime)\n\nrm(storage)\nstartTime <- Sys.time()\nar <- 1:len\nstorage <- fVec(ar, 3)\n\n(goodExec <- Sys.time() - startTime)\n```\n\nWhilst you should see performance benefits doing this, `Vectorize` is really just a wrapper function for some other base R functions which apply a function to a collection of elements without the same overheads seen by a `for` loop.\n\n## Vectorized Alternatives to Loops\n\n## Comparison of `apply()`, `lapply()`, and `sapply()`\n\n### `apply()`\n\n-   Used for applying functions to rows or columns of matrices and data frames.\n-   Returns a vector, matrix, or array depending on input and function used.\n\nExample:\n\n```{r}\nmatrix_data <- matrix(1:9, nrow=3)\napply(matrix_data, 1, sum)  # Row sums\napply(matrix_data, 2, sum)  # Column sums\n```\n\n### `lapply()`\n\n-   Used for lists and returns a **list**.\n-   Applies a function to each element of a list.\n\nExample:\n\n```{r}\nx <- list(a = 1:5, b = 6:10)\nlapply(x, mean)  # Returns a list with mean of each vector\n```\n\n### `sapply()`\n\n-   Similar to `lapply()`, but tries to simplify the output to a **vector** or **matrix** when possible.\n\nExample:\n\n```{r}\nx <- list(a = 1:5, b = 6:10)\nsapply(x, mean)  # Returns a named vector\n```\n\n### Key Differences\n\n| Function | Input Type | Output Type | Best For |\n|----|----|----|----|\n| `apply()` | Matrix/Data Frame | Vector/Matrix/Array | Applying functions to rows/columns |\n| `lapply()` | List | List | When output must remain a list |\n| `sapply()` | List | Vector/Matrix (if possible) | When output can be simplified |\n\n### `replicate()`\n\nAnother vectorised function is `replicate` which focuses on repeating an expression/function multiple times. This makes it very useful when you want multiple evaluations of the same or similar expression, such as in simulation tasks.\n\n```{r}\n\n(replicate(10, sample(1:10,1,T)))\n\n```\n\n## When to Use Vectorization\n\n-   When working with large datasets to improve efficiency.\n-   When performing mathematical operations on vectors or matrices.\n-   When using functions that inherently support vector inputs.\n\n## When Not to Use Vectorization\n\n-   When operations require sequential dependencies (e.g., recursive functions).\n-   When handling complex logical flows that require explicit iteration.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"output-file":"Vectors.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.6.42","theme":"cosmo","toc-location":"right"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}